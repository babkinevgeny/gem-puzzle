!function(e){function t(t){for(var o,a,s=t[0],c=t[1],u=t[2],d=0,m=[];d<s.length;d++)a=s[d],r[a]&&m.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(l&&l(t);m.length;)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={0:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;i.push([127,1]),n()}({127:function(e,t,n){n(128),e.exports=n(322)},320:function(e,t,n){"use strict";n.r(t),t.default=n.p+"c08906addecd186ccfe3f462fc1004ac.mp3"},322:function(e,t,n){"use strict";n.r(t);var o=n(126),r=n.n(o),i=n(38),a=n.n(i),s=n(45),c=n.n(s),u=n(46),l=n.n(u),d=n(320),m=function(){function e(){c()(this,e)}return l()(e,null,[{key:"createBasicHTML",value:function(){var t='\n      <header>\n        <ul class="tracker">\n          <li>\n            <span>Time: </span>\n            <span id="time">\n              <span id="minutes">00</span> : \n              <span id="seconds">00</span>\n            </span>\n          </li>\n          <li>\n            <span>Score: </span>\n            <span id="score"></span>\n          </li>\n        </ul>\n        <nav id="navigation" class="navigation navigation--hidden">\n          <ul class="navigation__list">\n            <li class="navigation__item"> \n              <h3>Gem Puzzle</h3>\n            </li>\n            <li class="navigation__item"> \n              <span>Change size: </span>\n              <select name="size" id="size">\n                <option value="3">3</option>\n                <option value="4" selected>4</option>\n                <option value="5">5</option>\n                <option value="6">6</option>\n                <option value="7">7</option>\n                <option value="8">8</option>\n              </select>\n            </li>\n            <li class="navigation__item">\n              <button id="start">New Game</button>\n            </li>\n            <li class="navigation__item">\n              <button id="save-btn">Save game</button>\n            </li>\n            <li class="navigation__item">\n              '.concat(e.getLoadBtn(),'\n            </li>\n            <li class="navigation__item">\n              <button id="solve">Solve</button>\n            </li>\n          </ul>\n        </nav>\n      </header>\n      <main>\n        <section id="puzzle" class="puzzle"></section>\n        <button class="switch sound" id="sound-btn"/>\n        <button class="switch store" id="store-btn"/>\n        <button class="switch menu" id="menu-btn"/>\n      </main>\n      <div id="shadow" class="shadow"></div>\n      <section id="popup" class="popup popup--hidden">\n        <h3>Congratulations! <br>You have solved puzzle for <span id="congrats-time"></span> and <span id="congrats-score"></span> turns</h3>\n      </section>\n      <section id="records" class="records records--hidden">\n        \n        ').concat(e.createRecords(),'\n      </section>\n      <audio src="').concat(d.default,'" id="moveSound"></audio>\n    ');document.querySelector("body").innerHTML=t}},{key:"getLoadBtn",value:function(){var e=document.createElement("button");return e.setAttribute("id","load-btn"),e.innerText="Load last saved game",localStorage.save||e.setAttribute("disabled",!0),e.outerHTML}},{key:"createRecords",value:function(){var e=JSON.parse(localStorage.getItem("records"));if(!e)return"<h3>There are no records. Win the game to be the first!</h3>";var t=Object.keys(e),n=document.createElement("ul"),o=document.createElement("h3");return o.innerText="Top 10 scores",t.forEach((function(t){var o=document.createElement("li"),r=document.createElement("h4");if(r.innerText=t,o.append(r),0===e[t].length){var i=document.createElement("span");i.innerText="There are no records yet",o.append(i)}else{var a=document.createElement("ol");e[t].forEach((function(e){var t=document.createElement("li"),n=1===e?"move":"moves";t.innerText="".concat(e," ").concat(n),a.append(t)})),o.append(a)}n.append(o)})),o.outerHTML+n.outerHTML}}]),e}(),p=function(){function e(){c()(this,e),this.minutesElem=document.getElementById("minutes"),this.secondsElem=document.getElementById("seconds")}return l()(e,[{key:"startTimer",value:function(t){this.totalSeconds=t||0,this.stopTimer(),this.minutesElem.innerHTML=this.totalSeconds?e.addZero(parseInt(this.totalSeconds/60,10)):"00",this.secondsElem.innerHTML=this.totalSeconds?e.addZero(this.totalSeconds%60):"00",this.setTimeInterval=setInterval(this.setTime.bind(this),1e3)}},{key:"getTime",value:function(){this.totalSeconds+=1;var t=e.addZero(this.totalSeconds%60);return[e.addZero(parseInt(this.totalSeconds/60,10)),t]}},{key:"setTime",value:function(){var e=this.getTime(),t=a()(e,2),n=t[0],o=t[1];this.minutesElem.innerHTML=n,this.secondsElem.innerHTML=o}},{key:"stopTimer",value:function(){clearInterval(this.setTimeInterval)}}],[{key:"addZero",value:function(e){var t="".concat(e);return t.length<2?"0".concat(t):t}}]),e}(),g=function(){function e(){c()(this,e),this.score=0,this.puzzleWrapper=document.querySelector("#puzzle"),this.progress=[],this.isEnabledAutoSolve=!1,this.isEnabledSound=!1}return l()(e,[{key:"start",value:function(t){var n=!1;t?(this.size=t.size,this.score=t.score,this.progress=t.progress,this.backgroundImage=t.backgroundImage,this.timer=new p(t.totalSeconds),n=!0):(this.timer=new p,this.size=+document.getElementById("size").value,this.score=0,this.progress=[],this.backgroundImage=e.getRandomImagePath()),this.timer.startTimer(),this.puzzleWrapper.innerHTML="",document.getElementById("store-btn").addEventListener("click",e.toggleRecords),this.navigation=document.getElementById("navigation"),document.getElementById("records").addEventListener("click",e.toggleRecords),this.init(n)}},{key:"init",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isEnabledAutoSolve=!1,this.puzzleWrapper.className="",this.puzzleWrapper.classList.add("puzzle"),this.puzzleWrapper.classList.add("puzzle--size-".concat(this.size,"x").concat(this.size));for(var o=this.size*this.size,r=0;r<o;r+=1){var i=r+1===o,a=this.createPuzzleItem(i,r+1);this.puzzleWrapper.appendChild(a)}if(n)this.gameStarted=!1,this.isMoveRecordEnabled=!1,e.prepareLoadedPuzzle();else{this.isMoveRecordEnabled=!0;for(var s=0;s<1.5*o;s+=1)this.gameStarted=!1,e.clickRandomItemAroundEmpty()}this.isMoveRecordEnabled=!0,setTimeout((function(){document.querySelectorAll(".puzzle__item").forEach((function(n){n.classList.add("puzzle__item--animation"),n.addEventListener("click",e.checkPuzzle.bind(t))}))}),0),this.gameStarted=!0,this.updateScore();var c=document.getElementById("popup");c.addEventListener("click",e.hidePopup),localStorage.records||this.constructor.generateStorage(),this.timer.stopTimer()}},{key:"createPuzzleItem",value:function(t,n){var o=this,r=document.createElement("div");r.classList.add("puzzle__item");var i=(n-1)%this.size,s=Math.floor((n-1)/this.size);return r.setAttribute("data-column",i),r.setAttribute("data-row",s),r.setAttribute("draggable",!0),r.style.backgroundImage=this.backgroundImage,r.style.backgroundPositionX="".concat(40*-i,"px"),r.style.backgroundPositionY="".concat(40*-s,"px"),t?(r.classList.add("puzzle__item--empty"),r.setAttribute("data-number","*"),r.innerText="",r):(r.setAttribute("data-number",n),r.innerText=n,r.addEventListener("click",(function(t){var r=e.getItemAttributes(t.target),i=a()(r,2),s=i[0],c=i[1];!1!==e.getIndexOfReplacedItem({col:s,row:c})&&(o.movePuzzleItem(s,c),o.recordMove({col:s,row:c,number:n}),o.increaseScore(),o.updateScore(),o.playMoveSound())})),r.addEventListener("dragend",(function(e){e.target.click()})),r)}},{key:"recordMove",value:function(e){this.isMoveRecordEnabled&&this.progress.push({col:e.col,row:e.row,number:e.number})}},{key:"movePuzzleItem",value:function(e,t){var n=document.querySelector('.puzzle__item[data-column="'.concat(e,'"][data-row="').concat(t,'"]')),o={col:e,row:t},r=this.constructor.countPosition(o);if(r){n.setAttribute("data-column",r.col),n.setAttribute("data-row",r.row),n.style[r.direction]="".concat(r.newItemPosition,"px");var i=document.querySelector(".puzzle__item--empty");i.setAttribute("data-column",e),i.setAttribute("data-row",t)}}},{key:"increaseScore",value:function(){this.gameStarted&&(this.score+=1)}},{key:"updateScore",value:function(){document.getElementById("score").innerText=this.score}},{key:"solvePuzzle",value:function(){var e=this;this.isEnabledSound&&this.toggleSound(),this.isEnabledAutoSolve=!0,this.gameStarted=!1,this.constructor.toggleShadow();for(var t=r()(this.progress),n=150,o=function(e){var o=document.querySelector('.puzzle__item[data-number="'.concat(t[e].number,'"]'));setTimeout((function(){o.click()}),n),n+=150},i=t.length-1;i>=0;i-=1)o(i);this.progress=[],setTimeout((function(){e.constructor.toggleShadow(),e.clearProgress()}),n)}},{key:"clearProgress",value:function(){this.progress=[]}},{key:"playMoveSound",value:function(){this.isEnabledSound&&document.querySelector("#moveSound").play()}},{key:"toggleSound",value:function(){this.isEnabledSound=!this.isEnabledSound,document.getElementById("sound-btn").classList.toggle("active")}},{key:"saveRecords",value:function(){var e=JSON.parse(localStorage.getItem("records")),t="".concat(this.size,"x").concat(this.size);e[t].push(this.score),e[t].sort(),e[t]=e[t].filter((function(e,t){return t<10})),window.localStorage.setItem("records",JSON.stringify(e))}},{key:"toggleMenu",value:function(){this.navigation.classList.toggle("navigation--hidden")}},{key:"saveGame",value:function(){var t={};t.progress=this.progress,t.size=this.size,t.score=this.score;var n=parseInt(document.getElementById("minutes").innerText,10),o=parseInt(document.getElementById("seconds").innerText,10);t.totalSeconds=60*n+o,t.backgroundImage=e.getCurrentImagePath(),localStorage.setItem("save",JSON.stringify(t)),this.toggleMenu(),document.getElementById("load-btn").removeAttribute("disabled")}},{key:"loadGame",value:function(){var e=JSON.parse(localStorage.save);e&&this.start(e),this.toggleMenu()}}],[{key:"getRandomImagePath",value:function(){var e=Math.floor(150*Math.random())+1;return'url("./assets/images/'.concat(e,'.jpg")')}},{key:"getCurrentImagePath",value:function(){var e=window.getComputedStyle(document.querySelector(".puzzle__item")).backgroundImage.split("/"),t=e[e.length-1];return'url("./assets/images/'.concat(t.slice(0,-2),'")')}},{key:"clickRandomItemAroundEmpty",value:function(){var t=this,n=document.querySelector(".puzzle__item--empty"),o=e.getItemAttributes(n),r=a()(o,2),i=r[0],s=r[1],c=[];[[i,s-1],[i-1,s],[i+1,s],[i,s+1]].forEach((function(e){var n=document.querySelector('.puzzle__item[data-column="'.concat(e[0],'"][data-row="').concat(e[1],'"]'));n&&n!==t.previousClickedItem&&c.push(n)}));var u=c[Math.floor(Math.random()*c.length)];u.click(),this.previousClickedItem=u}},{key:"countPosition",value:function(e){var t=window.getComputedStyle(document.querySelector('.puzzle__item[data-column="'.concat(e.col,'"][data-row="').concat(e.row,'"]'))),n=parseInt(t.top,10),o=parseInt(t.left,10),r=this.getMoveInfo(e);if(r)return{newItemPosition:"top"===r.direction?r.px+n:r.px+o,direction:r.direction,col:r.col,row:r.row}}},{key:"getValidItems",value:function(e){return[[e.col,e.row-1],[e.col-1,e.row],[e.col+1,e.row],[e.col,e.row+1]]}},{key:"getIndexOfReplacedItem",value:function(t){for(var n=e.getValidItems(t),o=0;o<n.length;o+=1){if(document.querySelector('.puzzle__item--empty[data-column="'.concat(n[o][0],'"][data-row="').concat(n[o][1],'"]')))return o}return!1}},{key:"getMoveInfo",value:function(t){var n=e.getIndexOfReplacedItem(t),o={};if("number"==typeof n){var r=document.querySelector(".puzzle__item--empty"),i=e.getItemAttributes(r),s=a()(i,2),c=s[0],u=s[1];o.col=c,o.row=u;var l=e.getPuzzleItemWidth();switch(n){case 0:o.direction="top",o.px=-l;break;case 1:o.direction="left",o.px=-l;break;case 2:o.direction="left",o.px=l;break;case 3:o.direction="top",o.px=l;break;default:o=void 0}}return o}},{key:"getPuzzleItemWidth",value:function(){var e=document.querySelector(".puzzle__item"),t=window.getComputedStyle(e);return parseInt(t.width,10)}},{key:"toggleShadow",value:function(){document.getElementById("shadow").classList.toggle("shadow--hidden")}},{key:"getItemAttributes",value:function(e){return[+e.getAttribute("data-column"),+e.getAttribute("data-row"),+e.getAttribute("data-number")]}},{key:"checkPuzzle",value:function(){if(!this.isEnabledAutoSolve){for(var t=document.querySelectorAll(".puzzle__item"),n=0;n<t.length-1;n+=1){var o=e.getItemAttributes(t[n]),r=a()(o,3),i=r[0],s=r[1],c=r[2],u=(c-1)%this.size;if(Math.floor((c-1)/this.size)!==s||u!==i)return}e.showPopup(),this.timer.stopTimer(),this.clearProgress(),this.saveRecords(),e.updateRecords()}}},{key:"showPopup",value:function(){var e=document.getElementById("popup"),t=document.getElementById("minutes").innerText,n=document.getElementById("seconds").innerText,o=document.getElementById("score").innerText,r=document.getElementById("congrats-time");document.getElementById("congrats-score").innerText=o,r.innerText="".concat(t," : ").concat(n),e.classList.remove("popup--hidden")}},{key:"hidePopup",value:function(){document.getElementById("popup").classList.add("popup--hidden")}},{key:"generateStorage",value:function(){for(var e={},t=3;t<9;t+=1)e["".concat(t,"x").concat(t)]=[];localStorage.setItem("records",JSON.stringify(e))}},{key:"toggleRecords",value:function(){document.getElementById("records").classList.toggle("records--hidden")}},{key:"updateRecords",value:function(){var e=document.getElementById("records"),t=m.createRecords();e.innerHTML=t}},{key:"prepareLoadedPuzzle",value:function(){var e=JSON.parse(localStorage.save);this.isMoveRecordEnabled=!1;for(var t=0;t<e.progress.length;t+=1){document.querySelector('.puzzle__item[data-number="'.concat(e.progress[t].number,'"')).click()}this.isMoveRecordEnabled=!0}}]),e}();n(321);m.createBasicHTML();var v=new p,h=new g(v);h.start(),v.startTimer();var f=function(){h.toggleMenu()},y=document.getElementById("solve");y.addEventListener("click",(function(){h.solvePuzzle(),v.stopTimer()})),y.addEventListener("click",f);var b=document.getElementById("start");b.addEventListener("click",(function(){h.start(),v.startTimer()})),b.addEventListener("click",f);document.getElementById("sound-btn").addEventListener("click",(function(){h.toggleSound()})),document.getElementById("menu-btn").addEventListener("click",f),document.getElementById("save-btn").addEventListener("click",h.saveGame.bind(h)),document.getElementById("load-btn").addEventListener("click",h.loadGame.bind(h))}});